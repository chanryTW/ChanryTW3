<!-- By睿大 © 2018 Chanry All Rights Reserved. 問題回報：chanrytw@gmail.com -->
<!DOCTYPE html>
<html lang="zh_TW">
	<head>
		<meta charset="utf-8"> 			
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<script src="./jquery.min.js"></script>		
		<link rel="stylesheet" href="./bootstrap.min.css">
		<link rel="stylesheet" href="./bootstrap-theme.min.css">
		<script src="./bootstrap.min.js"></script>		
		<title>金屬行銷組 格式產生器</title>
		
		<style>
			.index-top {
				background-color: rgb(46, 60, 53);
				padding: 1px 40px 10px 40px;
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 280px;
				z-index: 100;
			}
			.index-button {
				padding: 20px 40px 40px 40px;
				position: absolute;
				top: 290px;
				width: 100%;
			}
			#NewStringBox99 {
				resize: none;
			}
		</style>
	</head>
	<body>
		<div class="index-top">
			<p style="text-align:center; color: rgb(255, 255, 255);"><span style="font-size:40px; color: rgb(255, 255, 255);">金屬行銷組 格式產生器</span> 2018.06.13 update By Chanry</p>
			<h4 style="color: rgb(255, 255, 255);">累積文字：</h4>
			<textarea readonly class="form-control" cols="95" rows="3" id="NewStringBox99"></textarea>
			<button type="button" class="btn btn-success btn-block" onclick="IndexTopBtn1()">複製</button>
			<button type="button" class="btn btn-warning btn-block" onclick="IndexTopBtn2()">清空</button>		
			<br>

			<script type="text/javascript">
				function IndexTopBtn1(){
					document.getElementById('NewStringBox99').select()
   					document.execCommand('copy')
				}
				function IndexTopBtn2(){
					document.getElementById("NewStringBox99").innerHTML="";											
				}
			</script>

		</div>

		<div class="index-button">				
			<ul id="myTab" class="nav nav-tabs">
					<li class="active"><a href="#page1" data-toggle="tab">光電產業焦點</a></li>
					<li><a href="#page2" data-toggle="tab">風電產業焦點</a></li>
					<li><a href="#page3" data-toggle="tab">園區產業焦點</a></li>
					<li><a href="#page4" data-toggle="tab">大師專欄</a></li>
					<li><a href="#page5" data-toggle="tab">MII出版（個別產生）</a></li>
					<li><a href="#page8" data-toggle="tab">MII出版（一鍵產生）</a></li>
					<li><a href="#page9" data-toggle="tab">圖片上傳</a></li>
					<li><a href="#page6" data-toggle="tab">行政組-產業新聞</a></li>
					<li><a href="#page10" data-toggle="tab">研究組-光電新聞</a></li>
					<li><a href="#page7" data-toggle="tab">彙整大表狀態更新</a></li>
			</ul>
			
			<div id="myTabContent" class="tab-content">

				<!-- 光電產業焦點 -->
				<div class="tab-pane fade in active" id="page1">
					<h4>一鍵完成，直接將光電WORD檔「全選」「複製」貼於此處即可。</h4>
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox2"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString2()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox4">...</textarea>
					<p id="NewStringBox3">內文瀏覽</p>
			
					<script type="text/javascript">
						function ChangeString2(){
							var NewStringValue=document.getElementById("StringTextBox2").value;
							var lines = NewStringValue.split("\n"); 
							var string = ""; 
							string += '<table style="width: 768px; border-collapse: collapse; text-align: left;" cellspacing="0">';
							string += '	<tbody>';
							string += '	<tr><td>';
							string += '		<img style="width: 768px; height: 531px;" alt="" src="http://mii.mirdc.org.tw/Resources/Images/Upload/mike3mpq.jpg" />';
							string += '	</td></tr>	';
							string += '	<tr><td style="border: 0px currentColor;">';
							string += '	<br />';
							string += '			</td></tr>';
							string += '			<tr><td>';
							string += '					<div style="color: #000000; font-family: 標楷體; font-size: 20px;">';
							string += '						<div><div style="text-align: right;"><img alt="" src="http://mii.mirdc.org.tw/Resources/Images/Upload/yplikzqz.PNG" /></div></div>';
							
							var TitleText = [];
							
							// 先找出每個文章的開頭行數，然後放入陣列
							for (i=0;i<lines.length;i++) {
								if (lines[i].substr(0,3)=="TOP") {
									TitleText.push(i-1);
								}
							} 
							
							// 取每個陣列
							for (i=0;i<TitleText.length;i++) {
								// 標題部分
								string+= '<br /><strong><span style="color: #333399;font-size: 20px; font-family: 標楷體;">'+lines[TitleText[i]].substr(2)+lines[TitleText[i]+1].substr(3)+'</span></strong><br /><br />\n';									
								
								// 內文部分，判斷是否為最後一組
								if (i==TitleText.length-1) {
									for (j=TitleText[i]+3;j<lines.length;j++) {
									string+= '<div style=""color: #000000; font-family: 標楷體; font-size: 20px;"">　　'+lines[j]+'<br /></div>\n';																				
									}
								}else {
									for (j=TitleText[i]+3;j<TitleText[i+1];j++) {
									string+= '<div style=""color: #000000; font-family: 標楷體; font-size: 20px;"">　　'+lines[j]+'<br /></div>\n';																				
									}
								}
							} 

							string += '</div></td></tr></tbody></table><br />';

							document.getElementById("NewStringBox3").innerHTML=string;
							document.getElementById("NewStringBox4").value=string;
							document.getElementById("NewStringBox99").innerHTML+=string+"\n";											
						}
					</script>
				</div>

				<!-- 風電產業焦點 -->							
				<div class="tab-pane fade" id="page2">
					<h4>一鍵完成，直接將風電WORD檔「全選」「複製」貼於此處即可。</h4>
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox7"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString7()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox16">...</textarea>
					<p id="NewStringBox15">內文瀏覽</p>
			
					<script type="text/javascript">
						function ChangeString7(){
							var NewStringValue=document.getElementById("StringTextBox7").value;
							var lines = NewStringValue.split("\n"); 
							var string = ""; 
							string += '<table style="width: 768px; border-collapse: collapse;" cellspacing="0">';
							string += '	<tbody>';
							string += '	<tr><td>';
							string += '		<img style="width: 768px; height: 531px;" alt="" src="http://mii.mirdc.org.tw/Resources/Images/Upload/afttw2k5.JPG" />';
							string += '	</td></tr>	';
							string += '	<tr><td style="border: 0px currentColor;">';
							string += '	<br />';
							string += '			</td></tr>';
							string += '			<tr><td>';
							string += '					<div style="text-align: justify; color: #000000; font-family: 標楷體; font-size: 20px;">';
							string += '						<div style="text-align: right;"><img alt="" src="http://mii.mirdc.org.tw/Resources/Images/Upload/yplikzqz.PNG" /></div>';

							var TitleText = [];
							var CheckText = ["一、","二、","三、","四、","五、","六、","七、","八、","九、","十、"];

							// 先找出開始判斷的開頭，篩掉上面的目錄
							for (i=0;i<lines.length;i++) {
								if (lines[i]=='著作權所有，非經工業局書面同意，不得翻印或轉載 ') {
									var StartNumber = i;
								}
							}

							// 先找出每個文章的開頭行數，然後放入陣列
							for (i=StartNumber;i<lines.length;i++) {
								// 判斷標題的前三個字元中，有沒有CheckText陣列裡面的東西
								for (j=0;j<CheckText.length;j++) {
									if(lines[i].substr(0,3).indexOf(CheckText[j]) > -1) {
										TitleText.push(i);
										console.log(i);
									}
								}
							} 

							// 取每個陣列
							for (i=0;i<TitleText.length;i++) {
								// 標題部分
								string+= '<br /><strong><span style="color: #333399;font-size: 20px; font-family: 標楷體;">'+lines[TitleText[i]]+' ('+lines[TitleText[i]+1]+')</span></strong><br /><br />\n';									
								
								// 內文部分，判斷是否為最後一組
								if (i==TitleText.length-1) {
									for (j=TitleText[i]+2;j<lines.length;j++) {
									string+= '<div style=""color: #000000; font-family: 標楷體; font-size: 20px;"">　　'+lines[j]+'<br /></div>\n';																				
									}
								}else {
									for (j=TitleText[i]+2;j<TitleText[i+1];j++) {
									string+= '<div style=""color: #000000; font-family: 標楷體; font-size: 20px;"">　　'+lines[j]+'<br /></div>\n';																				
									}
								}
							} 

							string += '</div></td></tr></tbody></table>';

							document.getElementById("NewStringBox15").innerHTML=string;
							document.getElementById("NewStringBox16").value=string;
							document.getElementById("NewStringBox99").innerHTML+=string+"\n";											
						}
					</script>
				</div>

				<!-- 園區產業焦點 -->											
				<div class="tab-pane fade" id="page3">
					<h4>一鍵完成，直接點WORD檔中的內文區塊「複製」，然後直接貼於此處即可。（預設編號四十以內）</h4>
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox6"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString6()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox14">...</textarea>
					<p id="NewStringBox13">內文瀏覽</p>
			
					<script type="text/javascript">
						function ChangeString6(){
							var NewStringValue=document.getElementById("StringTextBox6").value;
							var lines = NewStringValue.split("\n"); 
							var string = ""; 
							string += '<table cellspacing="0" style="width: 768px; border-collapse: collapse;"><tbody><tr><td><img alt="" src="http://mii.mirdc.org.tw/Resources/Images/Upload/園區.JPG" style="width: 768px; height: 531px;" />&nbsp;	</td></tr><tr><td style="border: 0px currentcolor;"><br /></td></tr><tr><td><div style="text-align: justify; font-family: 標楷體; font-size: 20px;"><div style="text-align: right;"><img alt="" src="http://mii.mirdc.org.tw/Resources/Images/Upload/yplikzqz.PNG" /></div><div></div><div>';

							var TitleText = [];
							var NumberText = ["","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","二十一","二十二","二十三","二十四","二十五","二十六","二十七","二十八","二十九","三十","三十一","三十二","三十三","三十四","三十五","三十六","三十七","三十八","三十九","四十"];

							// 先找出每個文章的開頭行數，然後放入陣列
							for (i=0;i<lines.length;i++) {
								if (lines[i].substr(1,1)=="、" || lines[i].substr(2,1)=="、" || lines[i]=="園區雙週快訊" || lines[i]=="園區雙週快訊-國外新聞" || lines[i]=="活動資訊" || lines[i]=="政策掃描" || lines[i]=="地方園區") {
									TitleText.push(i);
								}
							} 

							// 取每個陣列
							for (i=0;i<TitleText.length;i++) {
								// 判斷如果是活動資訊 整段落不要
								if (lines[TitleText[i]]=="活動資訊") {
								}else {
									// 標題部分
									if (lines[TitleText[i]]=="園區雙週快訊" || lines[TitleText[i]]=="園區雙週快訊-國外新聞" || lines[TitleText[i]]=="政策掃描" || lines[TitleText[i]]=="地方園區") {
										string+= '<strong style="font-size: 20px;"><span style="color: #007138;font-size: 24px;">'+lines[TitleText[i]]+'</span></strong><br />\n';	
										var NumberTextN = 1;									
									}else if (lines[TitleText[i]].substr(1,1)=="、") {
										string+= '<br /><strong><span style="color: #333399;font-size: 20px; font-family: 標楷體;">'+NumberText[NumberTextN]+lines[TitleText[i]].substr(1)+'</span></strong><br />\n';	
										NumberTextN++;
									}else if (lines[TitleText[i]].substr(2,1)=="、") {
										string+= '<br /><strong><span style="color: #333399;font-size: 20px; font-family: 標楷體;">'+NumberText[NumberTextN]+lines[TitleText[i]].substr(2)+'</span></strong><br />\n';	
										NumberTextN++;									
									}
														
									// 內文部分，判斷是否為最後一組
									if (i==TitleText.length-1) {
										for (j=TitleText[i]+1;j<lines.length;j++) {
										string+= '<div style="color: #000000; font-family: 標楷體; font-size: 20px;">　　'+lines[j]+'<br /></div>\n';																				
										}
									}else {
										for (j=TitleText[i]+1;j<TitleText[i+1];j++) {
										string+= '<div style="color: #000000; font-family: 標楷體; font-size: 20px;">　　'+lines[j]+'<br /></div>\n';																				
										}
									}
								}
							} 

							string += '</div><div><br /></div><div><br /></div></div></td></tr></tbody></table><br />';
						
							document.getElementById("NewStringBox13").innerHTML=string;
							document.getElementById("NewStringBox14").value=string;
							document.getElementById("NewStringBox99").innerHTML+=string+"\n";
						}
					</script>
				</div>

				<!-- 大師專欄 -->											
				<div class="tab-pane fade" id="page4">
					<h4>第一列:標題 , 第二列以後:內文</h4>
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox1"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString1()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox6">...</textarea>
					<p id="NewStringBox5">內文瀏覽</p>
			
					<script type="text/javascript">
			
						function ChangeString1(){
							var NewStringValue1=document.getElementById("StringTextBox1").value;
							var lines = NewStringValue1.split("\n"); 
								var string = ""; 
								
								string+= '<h1 style="font-family: 標楷體;color: #000000;font-size: 24px">'+lines[0]+'</h1>\n';
			
								for(i=1;i<lines.length;i++){ 
								string+= '<h5 style="font-weight: normal;font-size: 18px;color: #000000; font-family: 標楷體;text-align: justify;">　　'+lines[i]+'</h5>\n';
								} 
								document.getElementById("NewStringBox5").innerHTML=string;
								document.getElementById("NewStringBox6").value=string;
								document.getElementById("NewStringBox99").innerHTML+=string+"\n";																			
						}
					</script>
				</div>

				<!-- MII出版（個別產生）-->															
				<div class="tab-pane fade" id="page5">
					<h4>第一列:大標題</h4>
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox3"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString3()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox8">...</textarea>
					<p id="NewStringBox7">內文瀏覽</p>
					
					<h4>第一列:小標題</h4>					
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox4"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString4()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox10">...</textarea>
					<p id="NewStringBox9">內文瀏覽</p>
					
					<h4>第一列以後:內文</h4>									
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox5"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString5()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox12">...</textarea>
					<p id="NewStringBox11">內文瀏覽</p>
			
					<script type="text/javascript">
			
						function ChangeString3(){
							var NewStringValue1=document.getElementById("StringTextBox3").value;
							var lines = NewStringValue1.split("\n"); 
								var string = ""; 
								
								string+= '<h1 style="font-family: 標楷體;color: #333399;font-size: 24px">'+lines[0]+'</h1>\n';
			
								document.getElementById("NewStringBox7").innerHTML=string;
								document.getElementById("NewStringBox8").value=string;
								document.getElementById("NewStringBox99").innerHTML+=string+"\n";																			
						}
						function ChangeString4(){
							var NewStringValue1=document.getElementById("StringTextBox4").value;
							var lines = NewStringValue1.split("\n"); 
								var string = ""; 
								
								string+= '<h2 style="font-family: 標楷體;color: #ff6600;font-size: 20px">'+lines[0]+'</h2>\n';
			
								document.getElementById("NewStringBox9").innerHTML=string;
								document.getElementById("NewStringBox10").value=string;
								document.getElementById("NewStringBox99").innerHTML+=string+"\n";																			
						}
						function ChangeString5(){
							var NewStringValue1=document.getElementById("StringTextBox5").value;
							var lines = NewStringValue1.split("\n"); 
								var string = ""; 
								
								for(i=0;i<lines.length;i++){ 
								string+= '<h5 style="font-weight: normal;font-size: 18px;color: #000000; font-family: 標楷體;text-align: justify;">　　'+lines[i]+'</h5>\n';
								} 
			
								document.getElementById("NewStringBox11").innerHTML=string;
								document.getElementById("NewStringBox12").value=string;
								document.getElementById("NewStringBox99").innerHTML+=string+"\n";																			
						}
					</script>
				</div>

				<!-- MII出版（一鍵產生） -->															
				<div class="tab-pane fade" id="page8">
					<h4>一鍵完成，先把表格都刪掉，然後將WORD檔「全選」「複製」貼於此處即可。（預設十大標十小標十圖片以內）</h4>
					<textarea class="form-control" cols="95" rows="2" id="StringTextBox8"></textarea>
					<br><input class="btn btn-default btn-block" type="button" value="執行" onclick="ChangeString8()"><br>
			
					<textarea class="form-control" cols="95" rows="2" id="NewStringBox17">...</textarea>
					<p id="NewStringBox18">內文瀏覽</p>
			
					<script type="text/javascript">
						function ChangeString8(){
							var NewStringValue=document.getElementById("StringTextBox8").value;
							var lines = NewStringValue.split("\n"); 
							var string = ""; 
							
							var TitleText = [];
							var TitleType = [];
							var CheckText = ["一、","二、","三、","四、","五、","六、","七、","八、","九、","十、"];
							var CheckText2 = ["（一）","（二）","（三）","（四）","（五）","（六）","（七）","（八）","（九）","（十）"];
							var CheckText3 = ["圖1","圖2","圖3","圖4","圖5","圖6","圖7","圖8","圖9","圖10"];

							// 先找出每個文章的開頭行數，然後放入陣列
							for (i=0;i<lines.length;i++) {
								// 判斷標題的前三個字元中，有沒有CheckText陣列裡面的東西
								for (j=0;j<CheckText.length;j++) {
									if(lines[i].substr(0,3).indexOf(CheckText[j]) > -1) {
										TitleText.push(i);
										TitleType.push("大"); //標記為大標題
										console.log(i+"大");
									}
								}
								for (j=0;j<CheckText2.length;j++) {
									if(lines[i].substr(0,4).indexOf(CheckText2[j]) > -1) {
										TitleText.push(i);
										TitleType.push("小"); //標記為小標題
										console.log(i+"小");
									}
								}
								for (j=0;j<CheckText3.length;j++) {
									if(lines[i].substr(0,4).indexOf(CheckText3[j]) > -1) {
										TitleText.push(i-1);
										TitleType.push("圖"); //標記為圖片
										console.log(i-1+"圖");
									}
								}
							} 
							
							// 取每個陣列
							for (i=0;i<TitleText.length;i++) {
								if (TitleType[i]=="大") {
									// 大標題部分
									string+= '<h1 style="font-family: 標楷體;color: #333399;font-size: 24px">'+lines[TitleText[i]]+'</h1>\n';
								}else if (TitleType[i]=="小") {
									// 小標題部分
									string+= '<h2 style="font-family: 標楷體;color: #ff6600;font-size: 20px">'+lines[TitleText[i]]+'</h2>\n';									
								}else if (TitleType[i]=="圖") {
									// 小標題部分
									string+= '這裡是圖片\n';									
									string+= '這裡是圖片\n';									
									string+= '這裡是圖片\n';									
								}
								
								// 內文部分，判斷是否為最後一組
								if (i==TitleText.length-1) {
									for (j=TitleText[i]+1;j<lines.length;j++) {
									string+= '<h5 style="font-weight: normal;font-size: 18px;color: #000000; font-family: 標楷體;text-align: justify;">　　'+lines[j]+'</h5>\n';																																																								
									}
								}else {
									if (TitleType[i]=="圖") {
										for (j=TitleText[i]+2;j<TitleText[i+1];j++) {
										string+= '<h5 style="font-weight: normal;font-size: 18px;color: #000000; font-family: 標楷體;text-align: justify;">　　'+lines[j]+'</h5>\n';																												
										}
									}else {
										for (j=TitleText[i]+1;j<TitleText[i+1];j++) {
										string+= '<h5 style="font-weight: normal;font-size: 18px;color: #000000; font-family: 標楷體;text-align: justify;">　　'+lines[j]+'</h5>\n';																												
										}
									}
								}
							}

							document.getElementById("NewStringBox18").innerHTML=string;
							document.getElementById("NewStringBox17").value=string;
							document.getElementById("NewStringBox99").innerHTML+=string+"\n";											
						}
					</script>
				</div>

				<!-- 圖片上傳 -->																			
				<div class="tab-pane fade" id="page9">
					<h4>測試中。</h4>					
					<form action="upload.php" method="post" enctype="multipart/form-data">
						<input type="file" name="file" id="file" /><br />
						<input type="submit" name="submit" value="上傳" />
					</form>
					
				</div>

				<!-- 行政組-產業新聞 -->											
				<div class="tab-pane fade" id="page6">
					<h4>一鍵完成，需使用後端，請先裝python3並下載下方檔案，有問題找睿大。（支援中國時報、經濟日報）</h4>
					<a download href="/download/DVGO.zip"><img style="width: 200px" src="/img/download.png" alt="下載檔案"></a><br>
					<img src="img/001.png" alt="">
				</div>

				<!-- 研究組-光電新聞 -->											
				<div class="tab-pane fade" id="page10">
					<h4>需使用後端，請先裝python3並下載下方檔案，有問題找睿大。（支援中國時報、經濟日報!、聯合新聞網、科技新報、財經新報、MoneyDJ!、鉅亨網、自由時報、工商時報）</h4>
					<p>1.將個別新聞網址放入。</p>
					<p>2.執行PCGO.py開始爬蟲，爬完蟲他結果會自動放到PCGO.xlsx。</p>
					<p>3.開啟PCGO.doc用合併列印匯入，然後存出結果即完成，記得校閱過。</p>
					<p>備註：如果標籤會不見，就把PCGO.doc全選複製貼到PCGO.docx即可。</p>
					<p>備註：如果有網址無法爬蟲，在網址前面加一個驚嘆號，可以標記略過，並保留空位。</p>
					<p>備註：如果有空格或是加了別的文字也沒關係，程式會自動略過，只處理網址。</p>
					<a download href="/download/PCGO.zip"><img style="width: 200px" src="/img/download.png" alt="下載檔案"></a><br>
					<img src="img/003.png" alt="">
					<img src="img/004.png" alt="">
					<img src="img/005.png" alt="">
				</div>

				<!-- 彙整大表狀態更新 -->											
				<div class="tab-pane fade" id="page7">
					<h4>一鍵完成，需使用後端，請先裝python3並下載下方檔案，有問題找睿大。</h4>
					<a download href="/download/RYGO.zip"><img style="width: 200px" src="/img/download.png" alt="下載檔案"></a><br>
					<img src="img/002.png" alt="">					
				</div>
			</div>
		</div>
	</body>
</html>